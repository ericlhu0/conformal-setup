<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Natural Language Feedback Data Generator</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }
        .section {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .section h3 {
            margin-top: 0;
            color: #555;
            border-bottom: 2px solid #007bff;
            padding-bottom: 5px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #666;
        }
        input[type="text"], input[type="number"], textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        textarea {
            height: 80px;
            resize: vertical;
        }
        .parameters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .parameter {
            background: white;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
            position: relative;
        }
        .parameter label {
            font-size: 12px;
            margin-bottom: 3px;
        }
        .parameter input {
            margin-bottom: 5px;
        }
        .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: none;
            color: #666;
            border: none;
            width: 20px;
            height: 20px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }
        .remove-btn:hover {
            color: #333;
        }
        .buttons {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-primary:hover {
            background-color: #0056b3;
        }
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #545b62;
        }
        .output {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            min-height: 100px;
            max-height: 400px;
            overflow-y: auto;
        }
        .output-entry {
            background: white;
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 10px;
            margin-bottom: 10px;
            position: relative;
        }
        .entry-header {
            font-weight: bold;
            color: #007bff;
            margin-bottom: 5px;
            font-size: 12px;
        }
        .remove-entry-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: none;
            color: #666;
            border: none;
            width: 16px;
            height: 16px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }
        .remove-entry-btn:hover {
            color: #333;
        }
        .output-section {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Natural Language Feedback Data Generator</h1>
        
        <div class="section">
            <h3>Current Parameter Values</h3>
            <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 15px;">
                <input type="text" id="newParameter" placeholder="Parameter name (e.g., temperature)" style="width: 200px;">
                <button class="btn-secondary" onclick="addParameter()">+ Add Parameter</button>
            </div>
            <div id="parametersList" style="font-size: 12px; color: #666; margin-bottom: 15px;">
                <!-- Current parameters will be listed here -->
            </div>
            <div class="buttons">
                <button class="btn-secondary" onclick="generateRandomValues()">Generate Random Values</button>
                <button class="btn-secondary" onclick="clearValues()">Clear All Values</button>
            </div>
            <div class="parameters" id="parameters">
                <!-- Parameters will be dynamically generated -->
            </div>
        </div>

        <div class="section">
            <h3>Natural Language Feedback</h3>
            <label for="feedback">User feedback about current system state:</label>
            <textarea id="feedback" placeholder="e.g., 'The temperature is too high', 'Speed feels good', 'Could you reduce the brightness?'"></textarea>
        </div>

        <div class="section">
            <h3>Desired Change in Parameter Values</h3>
            <p style="color: #666; font-size: 14px; margin-bottom: 15px;">
                Positive values increase parameter, negative values decrease it
            </p>
            <div class="parameters" id="desiredChanges">
                <!-- Desired parameter changes will be dynamically generated -->
            </div>
        </div>

        <div class="buttons">
            <button class="btn-primary" onclick="generateOutput()">Add Training Data</button>
            <button class="btn-secondary" onclick="copyOutput()">Copy All Output</button>
            <button class="btn-secondary" onclick="clearAllOutput()">Clear All Output</button>
        </div>

        <div class="output-section">
            <h3>Training Data Collection</h3>
            <div class="output" id="output">No training data generated yet. Click "Add Training Data" to create entries...</div>
        </div>
    </div>

    <script>
        let parameters = [
            "scale of sampled actions",
            "maximum velocity", 
            "MPC weight from distance-to-collision cost",
            "MPC weight from goal-reaching cost"
        ];
        let dataEntries = [];
        let entryCounter = 0;

        function updateParametersList() {
            const listContainer = document.getElementById('parametersList');
            listContainer.textContent = `Current parameters: ${parameters.join(', ')}`;
        }

        function removeParameter(paramName) {
            parameters = parameters.filter(param => param !== paramName);
            updateParametersList();
            initializeParameters();
        }

        function addParameter() {
            const newParamInput = document.getElementById('newParameter');
            const newParam = newParamInput.value;
            
            if (!newParam) {
                alert('Please enter a parameter name');
                return;
            }
            
            if (parameters.includes(newParam)) {
                alert('This parameter already exists');
                return;
            }
            
            parameters.push(newParam);
            newParamInput.value = '';
            updateParametersList();
            initializeParameters();
        }

        function initializeParameters() {
            const currentValuesContainer = document.getElementById('parameters');
            const desiredChangesContainer = document.getElementById('desiredChanges');
            
            currentValuesContainer.innerHTML = '';
            desiredChangesContainer.innerHTML = '';
            
            parameters.forEach(param => {
                // Current values
                const currentDiv = document.createElement('div');
                currentDiv.className = 'parameter';
                currentDiv.innerHTML = `
                    <button class="remove-btn" onclick="removeParameter('${param}')" title="Remove ${param}">Ã—</button>
                    <label for="current_${param}">${param.replace('_', ' ')}</label>
                    <div style="display: flex; gap: 5px; margin-bottom: 5px;">
                        <input type="number" id="min_${param}" value="1" min="0" max="1000" step="1" placeholder="Min" style="width: 50px; font-size: 11px;">
                        <input type="number" id="max_${param}" value="20" min="1" max="1000" step="1" placeholder="Max" style="width: 50px; font-size: 11px;">
                    </div>
                    <input type="number" id="current_${param}" min="0" max="1000" step="1" placeholder="Value">
                `;
                currentValuesContainer.appendChild(currentDiv);
                
                // Desired changes
                const desiredDiv = document.createElement('div');
                desiredDiv.className = 'parameter';
                desiredDiv.innerHTML = `
                    <label for="desired_${param}">${param.replace('_', ' ')}</label>
                    <input type="number" id="desired_${param}" min="-500" max="500" step="1" value="0" placeholder="Change">
                `;
                desiredChangesContainer.appendChild(desiredDiv);
            });
        }

        function generateRandomValues() {
            if (parameters.length === 0) {
                alert('Please add at least one parameter before generating random values');
                return;
            }
            
            parameters.forEach(param => {
                const minValue = parseInt(document.getElementById(`min_${param}`).value) || 1;
                const maxValue = parseInt(document.getElementById(`max_${param}`).value) || 100;
                
                if (minValue >= maxValue) {
                    alert(`Min value must be less than max value for parameter: ${param}`);
                    return;
                }
                
                const input = document.getElementById(`current_${param}`);
                const randomValue = Math.floor(Math.random() * (maxValue - minValue + 1)) + minValue;
                input.value = randomValue;
            });
        }

        function clearValues() {
            parameters.forEach(param => {
                const currentInput = document.getElementById(`current_${param}`);
                const desiredInput = document.getElementById(`desired_${param}`);
                const minInput = document.getElementById(`min_${param}`);
                const maxInput = document.getElementById(`max_${param}`);
                
                if (currentInput) currentInput.value = '';
                if (desiredInput) desiredInput.value = '0';
                if (minInput) minInput.value = '1';
                if (maxInput) maxInput.value = '20';
            });
            document.getElementById('feedback').value = '';
        }

        function generateOutput() {
            const feedback = document.getElementById('feedback').value.trim();
            
            if (!feedback) {
                alert('Please provide natural language feedback');
                return;
            }

            if (parameters.length === 0) {
                alert('Please add at least one parameter before generating output');
                return;
            }

            entryCounter++;
            let entryData = {
                id: entryCounter,
                currentParams: {},
                feedback: feedback,
                desiredChanges: {}
            };

            // Collect current parameter values
            parameters.forEach(param => {
                const currentValue = document.getElementById(`current_${param}`).value;
                if (currentValue) {
                    entryData.currentParams[param] = currentValue;
                }
            });

            // Collect desired changes
            parameters.forEach(param => {
                const desiredChange = document.getElementById(`desired_${param}`).value;
                if (desiredChange !== '') {
                    entryData.desiredChanges[param] = desiredChange;
                }
            });

            dataEntries.push(entryData);
            renderOutput();
            
            // Reset desired changes to 0 and clear feedback for next entry
            parameters.forEach(param => {
                const desiredInput = document.getElementById(`desired_${param}`);
                if (desiredInput) desiredInput.value = '0';
            });
            document.getElementById('feedback').value = '';
        }

        function removeEntry(entryId) {
            dataEntries = dataEntries.filter(entry => entry.id !== entryId);
            renderOutput();
        }

        function clearAllOutput() {
            dataEntries = [];
            entryCounter = 0;
            renderOutput();
        }

        function renderOutput() {
            const outputContainer = document.getElementById('output');
            
            if (dataEntries.length === 0) {
                outputContainer.innerHTML = 'No training data generated yet. Click "Add Training Data" to create entries...';
                return;
            }

            let outputHTML = '';
            
            dataEntries.forEach(entry => {
                outputHTML += `<div class="output-entry">`;
                outputHTML += `<div class="entry-header">Entry #${entry.id}</div>`;
                outputHTML += `<button class="remove-entry-btn" onclick="removeEntry(${entry.id})" title="Remove entry">Ã—</button>`;
                
                // Current parameters
                outputHTML += `Current Parameter Values:\n`;
                for (const [param, value] of Object.entries(entry.currentParams)) {
                    outputHTML += `${param}: ${value}\n`;
                }
                
                // Feedback
                outputHTML += `\nFeedback: "${entry.feedback}"\n\n`;
                
                // Desired changes
                outputHTML += `Desired Changes in Parameter Values:\n`;
                for (const [param, change] of Object.entries(entry.desiredChanges)) {
                    outputHTML += `${param}: ${change > 0 ? '+' : ''}${change}\n`;
                }
                
                outputHTML += `</div>`;
            });
            
            outputContainer.innerHTML = outputHTML;
        }

        function copyOutput() {
            if (dataEntries.length === 0) {
                alert('No output to copy. Generate training data first.');
                return;
            }
            
            let textOutput = '';
            
            dataEntries.forEach((entry, index) => {
                if (index > 0) textOutput += '\n---\n\n';
                
                textOutput += `Entry #${entry.id}\n\n`;
                
                // Current parameters
                textOutput += `Current Parameter Values:\n`;
                for (const [param, value] of Object.entries(entry.currentParams)) {
                    textOutput += `${param}: ${value}\n`;
                }
                
                // Feedback
                textOutput += `\nFeedback: "${entry.feedback}"\n\n`;
                
                // Desired changes
                textOutput += `Desired Changes in Parameter Values:\n`;
                for (const [param, change] of Object.entries(entry.desiredChanges)) {
                    textOutput += `${param}: ${change > 0 ? '+' : ''}${change}\n`;
                }
            });
            
            navigator.clipboard.writeText(textOutput).then(() => {
                alert('All output copied to clipboard!');
            }).catch(err => {
                alert('Failed to copy output');
            });
        }

        // Initialize the interface
        document.addEventListener('DOMContentLoaded', function() {
            updateParametersList();
            initializeParameters();
            renderOutput();
        });
    </script>
</body>
</html>